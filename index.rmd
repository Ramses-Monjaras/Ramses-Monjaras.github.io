---
title: "Video Game Data"
author: "Ramses Monjaras"
date: "`r Sys.Date()`"
output: html_document
---
```{r setup, include=FALSE}
library(tidyverse)
library(boot)
library(dplyr)
library(tidyr)
library(ggplot2)
knitr::opts_chunk$set(echo = TRUE)
df <- read.csv("game_dataset.csv")
```
  Video games are very popular, that thousands of them get released throughout the years on different platforms. I started to wonder which platforms have the best games and active player base. You can find this data set in the [Kaggle](https://www.kaggle.com/datasets/zafarali27/game-data) website. In the data set the game ID, name, genre, release year and platform are all categorical variables. The global sales, user rating, and active players are all quantitative variables and they are also all ordinal. This data set seems to be cleaned from the start, so I didn't touch anything. Below is what my data set look like.
```{r}
  df[1:10,]
```
# Part 1
For one of my quantitative variable, I am going to take the user rating to give the summary statistics. Below is the five point summary which is min = 1.0, Q1 = 3.3, med = 5.5, Q3 = 7.6, and max = 10. The mean is 5.476 and the standard deviation is 2.562662. Below is also a histogram of the user score.
```{r}
summary(df$User_Rating)
sd(df$User_Rating)
```
```{r}
ggplot(df, aes(x = User_Rating)) + geom_histogram() + labs(title = "User Ratings") + geom_histogram(color = 'black')
```
 
  As you can see in the histogram, x-axis is the user rating and the y-axis is the rating count. It looks like people gave a lot of games a 4 rating which tells me that there is not a lot of games that people will rate a high score. The graph look noisy and all over the place.The graph also doesn't look like it is skewed. 
```{r}
ggplot(data = df, aes(x = Platform, y = User_Rating)) + geom_boxplot(color = 'black') + labs(title = "Box Plot of User Ratings by Platform", x = "Platform", y = "User Rating")
```
```{r}
five_point_summary <- df |>
  group_by(Platform) |>
  summarise(
    Min = min(User_Rating, na.rm = TRUE),
    Q1 = quantile(User_Rating, 0.25, na.rm = TRUE),
    Median = median(User_Rating, na.rm = TRUE),
    Q3 = quantile(User_Rating, 0.75, na.rm = TRUE),
    Max = max(User_Rating, na.rm = TRUE),
    Mean = mean(User_Rating, na.rm = TRUE)
  )

print(five_point_summary)
```

As you can see in the box plot above, the x-axis is the different platforms and the y-axis is the user ratings. It looks like there are no outliers in the box plots. What I find interesting is the switch games having a lower user rating on average compared to the other platforms. This side-by-side plot also shows how many high rated games are on each platform. It looks like Xbox games has a higher user rating compared to the other platforms. Next, I will take a categorical variable to create a frequency and a relative frequency table. Below is the frequency table and relative frequency.
```{r}
df |> count(Genre) |>
  mutate(relative_frequency = n / sum(n))
```
The total count of the genre is 2,000 and the total count of the relative frequency is 1. What I found interesting is that there are more racing games compared to all the different genres.
```{r}
two_way_table <- df |>
  count(Platform, Genre) |>
  pivot_wider(names_from = Genre, values_from = n, values_fill = list(n = 0))
print(two_way_table)
```
In the two-way table above, the table shows the different amount of genres that each platform has. I find interesting that there is a lot of Pc racing games but less amount of shooter games in the PC platform. The possible relationship of these two variables is that, if you are interested in a specific genre of games, then you can look at this table and see which platform has the most of that genre.

In conclusion, what I found interesting that Switch games have a lower user rating on average and Xbox games has the highest rating on average. I also find that there are more racing games among each platform compared to all the different types of genres. I expected to be more shooter games then racing games.

# Part 2

```{r}
model <- lm(Active_Players ~ User_Rating, data = df)
summary(model)


plot(df$User_Rating, df$Active_Players, xlab="User Rating", ylab="Active Players" )

abline(model, col="red")
```

As you can see this simple y ~ x regression is very all over the place and the regression line seems to be in a straight line. This tells me that if a game has a high rating, that doesn't mean people will keep playing the game. I also include statistics above that shows the five point summary of the regression. Below will be the multiple regression.

```{r}
# Fit the multiple regression model
model <- lm(Active_Players ~ User_Rating + Global_Sales + Release_Year, data = df)

# Display the summary of the model
summary(model)

# Scatter plots of y vs each predictor
par(mfrow = c(1, 3))
plot(df$User_Rating, df$Active_Players, main = "y vs x1", xlab = "x1", ylab = "y", pch = 16, col = "blue")
abline(lm(Active_Players ~ User_Rating, data = df), col = "red")

plot(df$Global_Sales, df$Active_Players, main = "y vs x2", xlab = "x2", ylab = "y", pch = 16, col = "green")
abline(lm(Active_Players~ Global_Sales, data = df), col = "red")

plot(df$Release_Year, df$Active_Players, main = "y vs x3", xlab = "x3", ylab = "y", pch = 16, col = "purple")
abline(lm(Active_Players~ Release_Year, data = df), col = "red")

# Diagnostic plots
par(mfrow = c(2, 2))
plot(model)

# Extract and print statistics
coefficients <- coef(model)
print(coefficients)

r_squared <- summary(model)$r.squared
adj_r_squared <- summary(model)$adj.r.squared
print(paste("R-squared:", r_squared))
print(paste("Adjusted R-squared:", adj_r_squared))

p_values <- summary(model)$coefficients[, 4]
print(p_values)
```